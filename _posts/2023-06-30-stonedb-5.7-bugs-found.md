# 2023-07-70-stonedb-5.7-bugs-found.md

Potential Bugs Found:

1. Column length too big for column 'c0' (max = 16383); use BLOB or TEXT instead
```sql
--java.lang.AssertionError: CREATE TABLE t0(c0 VARCHAR(65079) STORAGE MEMORY COLUMN_FORMAT DYNAMIC, c1 TIME  NULL COLUMN_FORMAT DYNAMIC) ;
--	at sqlancer.common.query.SQLQueryAdapter.checkException(SQLQueryAdapter.java:111)
--	at sqlancer.common.query.SQLQueryAdapter.execute(SQLQueryAdapter.java:93)
--	at sqlancer.Main$QueryManager.execute(Main.java:289)
--	at sqlancer.GlobalState.executeStatement(GlobalState.java:108)
--	at sqlancer.stonedb.StoneDBProvider.generateDatabase(StoneDBProvider.java:83)
--	at sqlancer.stonedb.StoneDBProvider.generateDatabase(StoneDBProvider.java:1)
--	at sqlancer.ProviderAdapter.generateAndTestDatabase(ProviderAdapter.java:52)
--	at sqlancer.Main$DBMSExecutor.run(Main.java:388)
--	at sqlancer.Main$2.run(Main.java:583)
--	at sqlancer.Main$2.runThread(Main.java:565)
--	at sqlancer.Main$2.run(Main.java:556)
--	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
--	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
--	at java.base/java.lang.Thread.run(Thread.java:829)
--Caused by: java.sql.SQLSyntaxErrorException: Column length too big for column 'c0' (max = 16383); use BLOB or TEXT instead
--	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
--	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
--	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763)
--	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648)
--	at sqlancer.common.query.SQLQueryAdapter.execute(SQLQueryAdapter.java:87)
--	... 12 more
---- Time: 2023/06/30 16:00:15
-- Database: database16
-- Database version: 5.7.36-StoneDB-v1.0.3
-- seed value: 1688140815475
DROP DATABASE IF EXISTS database16;
CREATE DATABASE database16;
USE database16;
CREATE TEMPORARY TABLE IF NOT EXISTS t0(c0 DATETIME COMMENT ''  COLUMN_FORMAT FIXED STORAGE DISK) ;

```


```sql
--java.lang.AssertionError: SELECT * FROM t0 WHERE ((t0.c1)XOR(0.3675585217931042)) UNION ALL SELECT * FROM t0 WHERE (NOT ((t0.c1)XOR(0.3675585217931042))) UNION ALL SELECT * FROM t0 WHERE ((((t0.c1)XOR(0.3675585217931042))) IS NULL);
--	at sqlancer.common.query.SQLQueryAdapter.checkException(SQLQueryAdapter.java:111)
--	at sqlancer.common.query.SQLQueryAdapter.executeAndGet(SQLQueryAdapter.java:141)
--	at sqlancer.ComparatorHelper.getResultSetFirstColumnAsString(ComparatorHelper.java:55)
--	at sqlancer.ComparatorHelper.getCombinedResultSet(ComparatorHelper.java:149)
--	at sqlancer.stonedb.oracle.StoneDBQueryPartitioningWhereTester.check(StoneDBQueryPartitioningWhereTester.java:36)
--	at sqlancer.ProviderAdapter.generateAndTestDatabase(ProviderAdapter.java:61)
--	at sqlancer.Main$DBMSExecutor.run(Main.java:388)
--	at sqlancer.Main$2.run(Main.java:583)
--	at sqlancer.Main$2.runThread(Main.java:565)
--	at sqlancer.Main$2.run(Main.java:556)
--	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
--	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
--	at java.base/java.lang.Thread.run(Thread.java:829)
--Caused by: java.sql.SQLException: The query includes syntax that is not supported by the storage engine. Either restructure the query with supported syntax, or enable the MySQL core::Query Path in config file to execute the query with reduced performance.
--	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129)
--	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
--	at com.mysql.cj.jdbc.StatementImpl.executeQuery(StatementImpl.java:1200)
--	at sqlancer.common.query.SQLQueryAdapter.executeAndGet(SQLQueryAdapter.java:131)
--	... 11 more
---- Time: 2023/07/12 07:54:23
-- Database: database3
-- Database version: 5.7.36-StoneDB-v1.0.4}
-- seed value: 1689148456439
DROP DATABASE IF EXISTS database3;
CREATE DATABASE database3;
USE database3;
CREATE TABLE t0(c0 BLOB STORAGE MEMORY COLUMN_FORMAT DEFAULT COMMENT '' ) ;
DELETE QUICK FROM t0 WHERE (('()') IS NOT NULL) LIMIT 0;
ALTER TABLE t0 CHANGE c0 c1 VARCHAR(3799) ;
ALTER TABLE t0 ALTER COLUMN c1 SET DEFAULT 'kX' ;
ALTER TABLE t0 ALTER c1 SET DEFAULT '' ;
```







## TODO



Docker image size bug


TIANMU engine but InnoDB engine bug.
<img width="1728" alt="image" src="https://github.com/ZhengLin-Li/ZhengLin-Li.github.io.jekflix/assets/63448884/3b577454-c171-4af5-a412-0443e870f50a">
